(function(){"use strict";var e=false;var r=r||self;var t=typeof r!=="undefined"?r:typeof global!=="undefined"?global:this;function n(e,r){return r={exports:{}},e(r,r.exports,t),r.exports}var o={};o.typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol?"symbol":typeof e};o;var i=n(function(n,o,i){(function(){var e,t,n,o;(function(){var r={},i={};e=function(e,t,n){r[e]={deps:t,callback:n}};o=n=t=function(e){o._eak_seen=r;if(i[e]){return i[e]}i[e]={};if(!r[e]){throw new Error("Could not find module "+e)}var n=r[e],a=n.deps,s=n.callback,u=[],f;for(var c=0,l=a.length;c<l;c++){if(a[c]==="exports"){u.push(f={})}else{u.push(t(d(a[c])))}}var v=s.apply(this,u);return i[e]=f||v;function d(r){if(r.charAt(0)!=="."){return r}var t=r.split("/");var n=e.split("/").slice(0,-1);for(var o=0,i=t.length;o<i;o++){var a=t[o];if(a===".."){n.pop()}else if(a==="."){continue}else{n.push(a)}}return n.join("/")}}})();e("promise/all",["./utils","exports"],function(e,r){"use strict";var t=e.isArray;var n=e.isFunction;function o(e){var r=this;if(!t(e)){throw new TypeError("You must pass an array to all.")}return new r(function(r,t){var o=[],i=e.length,a;if(i===0){r([])}function s(e){return function(r){u(e,r)}}function u(e,t){o[e]=t;if(--i===0){r(o)}}for(var f=0;f<e.length;f++){a=e[f];if(a&&n(a.then)){a.then(s(f),t)}else{u(f,a)}}})}r.all=o});e("promise/asap",["exports"],function(e){"use strict";var t=typeof r!=="undefined"?r:{};var n=t.MutationObserver||t.WebKitMutationObserver;var o=typeof i!=="undefined"?i:this===undefined?r:this;function a(){return function(){process.nextTick(c)}}function s(){var e=0;var r=new n(c);var t=document.createTextNode("");r.observe(t,{characterData:true});return function(){t.data=e=++e%2}}function u(){return function(){o.setTimeout(c,1)}}var f=[];function c(){for(var e=0;e<f.length;e++){var r=f[e];var t=r[0],n=r[1];t(n)}f=[]}var l;if(typeof process!=="undefined"&&{}.toString.call(process)==="[object process]"){l=a()}else if(n){l=s()}else{l=u()}function v(e,r){var t=f.push([e,r]);if(t===1){l()}}e.asap=v});e("promise/config",["exports"],function(e){"use strict";var r={instrument:false};function t(e,t){if(arguments.length===2){r[e]=t}else{return r[e]}}e.config=r;e.configure=t});e("promise/polyfill",["./promise","./utils","exports"],function(e,t,n){"use strict";var o=e.Promise;var a=t.isFunction;function s(){var e;if(typeof i!=="undefined"){e=i}else if(typeof r!=="undefined"&&r.document){e=r}else{e=self}var t="Promise"in e&&"resolve"in e.Promise&&"reject"in e.Promise&&"all"in e.Promise&&"race"in e.Promise&&function(){var r;new e.Promise(function(e){r=e});return a(r)}();if(!t){e.Promise=o}}n.polyfill=s});e("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(e,r,t,n,o,i,a,s){"use strict";var u=e.config;var f=e.configure;var c=r.objectOrFunction;var l=r.isFunction;var v=r.now;var d=t.all;var h=n.race;var p=o.resolve;var y=i.reject;var m=a.asap;var b=0;u.async=m;function g(e){if(!l(e)){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}if(!(this instanceof g)){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}this._subscribers=[];w(e,this)}function w(e,r){function t(e){j(r,e)}function n(e){N(r,e)}try{e(t,n)}catch(e){n(e)}}function _(e,r,t,n){var o=l(t),i,a,s,u;if(o){try{i=t(n);s=true}catch(e){u=true;a=e}}else{i=n;s=true}if(k(r,i)){return}else if(o&&s){j(r,i)}else if(u){N(r,a)}else if(e===I){j(r,i)}else if(e===A){N(r,i)}}var S=void 0;var E=0;var I=1;var A=2;function x(e,r,t,n){var o=e._subscribers;var i=o.length;o[i]=r;o[i+I]=t;o[i+A]=n}function P(e,r){var t,n,o=e._subscribers,i=e._detail;for(var a=0;a<o.length;a+=3){t=o[a];n=o[a+r];_(r,t,n,i)}e._subscribers=null}g.prototype={constructor:g,_state:undefined,_detail:undefined,_subscribers:undefined,then:function(e,r){var t=this;var n=new this.constructor(function(){});if(this._state){var o=arguments;u.async(function e(){_(t._state,n,o[t._state-1],t._detail)})}else{x(this,n,e,r)}return n},catch:function(e){return this.then(null,e)}};g.all=d;g.race=h;g.resolve=p;g.reject=y;function k(e,r){var t=null,n;try{if(e===r){throw new TypeError("A promises callback cannot return that same promise.")}if(c(r)){t=r.then;if(l(t)){t.call(r,function(t){if(n){return true}n=true;if(r!==t){j(e,t)}else{C(e,t)}},function(r){if(n){return true}n=true;N(e,r)});return true}}}catch(r){if(n){return true}N(e,r);return true}return false}function j(e,r){if(e===r){C(e,r)}else if(!k(e,r)){C(e,r)}}function C(e,r){if(e._state!==S){return}e._state=E;e._detail=r;u.async(O,e)}function N(e,r){if(e._state!==S){return}e._state=E;e._detail=r;u.async(D,e)}function O(e){P(e,e._state=I)}function D(e){P(e,e._state=A)}s.Promise=g});e("promise/race",["./utils","exports"],function(e,r){"use strict";var t=e.isArray;function n(e){var r=this;if(!t(e)){throw new TypeError("You must pass an array to race.")}return new r(function(r,t){var n=[],o;for(var i=0;i<e.length;i++){o=e[i];if(o&&typeof o.then==="function"){o.then(r,t)}else{r(o)}}})}r.race=n});e("promise/reject",["exports"],function(e){"use strict";function r(e){var r=this;return new r(function(r,t){t(e)})}e.reject=r});e("promise/resolve",["exports"],function(e){"use strict";function r(e){if(e&&typeof e==="object"&&e.constructor===this){return e}var r=this;return new r(function(r){r(e)})}e.resolve=r});e("promise/utils",["exports"],function(e){"use strict";function r(e){return t(e)||typeof e==="object"&&e!==null}function t(e){return typeof e==="function"}function n(e){return Object.prototype.toString.call(e)==="[object Array]"}var o=Date.now||function(){return(new Date).getTime()};e.objectOrFunction=r;e.isFunction=t;e.isArray=n;e.now=o});t("promise/polyfill").polyfill()})();(function r(t,i){if(typeof o==="object"&&typeof n==="object")n.exports=i();else if(typeof e==="function"&&e.amd)e([],i);else if(typeof o==="object")o["localforage"]=i();else t["localforage"]=i()})(t,function(){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:false};e[n].call(o.exports,o,o.exports,t);o.loaded=true;return o.exports}t.m=e;t.c=r;t.p="";return t(0)}([function(e,t,n){"use strict";t.__esModule=true;function o(e,r){if(!(e instanceof r)){throw new TypeError("Cannot call a class as a function")}}var i=function(e){"use strict";var r={};var t={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"};var i=[t.INDEXEDDB,t.WEBSQL,t.LOCALSTORAGE];var a=["clear","getItem","iterate","key","keys","length","removeItem","setItem"];var s={description:"",driver:i.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};var u=function(e){var r={};r[t.INDEXEDDB]=!!function(){try{var r=r||e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.OIndexedDB||e.msIndexedDB;if(typeof e.openDatabase!=="undefined"&&e.navigator&&e.navigator.userAgent&&/Safari/.test(e.navigator.userAgent)&&!/Chrome/.test(e.navigator.userAgent)){return false}return r&&typeof r.open==="function"&&typeof e.IDBKeyRange!=="undefined"}catch(e){return false}}();r[t.WEBSQL]=!!function(){try{return e.openDatabase}catch(e){return false}}();r[t.LOCALSTORAGE]=!!function(){try{return e.localStorage&&"setItem"in e.localStorage&&e.localStorage.setItem}catch(e){return false}}();return r}(e);var f=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function c(e,r){e[r]=function(){var t=arguments;return e.ready().then(function(){return e[r].apply(e,t)})}}function l(){for(var e=1;e<arguments.length;e++){var r=arguments[e];if(r){for(var t in r){if(r.hasOwnProperty(t)){if(f(r[t])){arguments[0][t]=r[t].slice()}else{arguments[0][t]=r[t]}}}}}return arguments[0]}function v(e){for(var r in t){if(t.hasOwnProperty(r)&&t[r]===e){return true}}return false}var d=function(){function e(r){o(this,e);this.INDEXEDDB=t.INDEXEDDB;this.LOCALSTORAGE=t.LOCALSTORAGE;this.WEBSQL=t.WEBSQL;this._defaultConfig=l({},s);this._config=l({},this._defaultConfig,r);this._driverSet=null;this._initDriver=null;this._ready=false;this._dbInfo=null;this._wrapLibraryMethodsWithReady();this.setDriver(this._config.driver)}e.prototype.config=function e(r){if(typeof r==="object"){if(this._ready){return new Error("Can't call config() after localforage "+"has been used.")}for(var t in r){if(t==="storeName"){r[t]=r[t].replace(/\W/g,"_")}this._config[t]=r[t]}if("driver"in r&&r.driver){this.setDriver(this._config.driver)}return true}else if(typeof r==="string"){return this._config[r]}else{return this._config}};e.prototype.defineDriver=function e(t,n,o){var i=new Promise(function(e,n){try{var o=t._driver;var i=new Error("Custom driver not compliant; see "+"https://mozilla.github.io/localForage/#definedriver");var s=new Error("Custom driver name already in use: "+t._driver);if(!t._driver){n(i);return}if(v(t._driver)){n(s);return}var f=a.concat("_initStorage");for(var c=0;c<f.length;c++){var l=f[c];if(!l||!t[l]||typeof t[l]!=="function"){n(i);return}}var d=Promise.resolve(true);if("_support"in t){if(t._support&&typeof t._support==="function"){d=t._support()}else{d=Promise.resolve(!!t._support)}}d.then(function(n){u[o]=n;r[o]=t;e()},n)}catch(e){n(e)}});i.then(n,o);return i};e.prototype.driver=function e(){return this._driver||null};e.prototype.getDriver=function e(t,o,i){var a=this;var s=function(){if(v(t)){switch(t){case a.INDEXEDDB:return new Promise(function(e,r){e(n(1))});case a.LOCALSTORAGE:return new Promise(function(e,r){e(n(2))});case a.WEBSQL:return new Promise(function(e,r){e(n(4))})}}else if(r[t]){return Promise.resolve(r[t])}return Promise.reject(new Error("Driver not found."))}();s.then(o,i);return s};e.prototype.getSerializer=function e(r){var t=new Promise(function(e,r){e(n(3))});if(r&&typeof r==="function"){t.then(function(e){r(e)})}return t};e.prototype.ready=function e(r){var t=this;var n=t._driverSet.then(function(){if(t._ready===null){t._ready=t._initDriver()}return t._ready});n.then(r,r);return n};e.prototype.setDriver=function e(r,t,n){var o=this;if(!f(r)){r=[r]}var i=this._getSupportedDrivers(r);function a(){o._config.driver=o.driver()}function s(e){return function(){var r=0;function t(){while(r<e.length){var n=e[r];r++;o._dbInfo=null;o._ready=null;return o.getDriver(n).then(function(e){o._extend(e);a();o._ready=o._initStorage(o._config);return o._ready})["catch"](t)}a();var i=new Error("No available storage method found.");o._driverSet=Promise.reject(i);return o._driverSet}return t()}}var u=this._driverSet!==null?this._driverSet["catch"](function(){return Promise.resolve()}):Promise.resolve();this._driverSet=u.then(function(){var e=i[0];o._dbInfo=null;o._ready=null;return o.getDriver(e).then(function(e){o._driver=e._driver;a();o._wrapLibraryMethodsWithReady();o._initDriver=s(i)})})["catch"](function(){a();var e=new Error("No available storage method found.");o._driverSet=Promise.reject(e);return o._driverSet});this._driverSet.then(t,n);return this._driverSet};e.prototype.supports=function e(r){return!!u[r]};e.prototype._extend=function e(r){l(this,r)};e.prototype._getSupportedDrivers=function e(r){var t=[];for(var n=0,o=r.length;n<o;n++){var i=r[n];if(this.supports(i)){t.push(i)}}return t};e.prototype._wrapLibraryMethodsWithReady=function e(){for(var r=0;r<a.length;r++){c(this,a[r])}};e.prototype.createInstance=function r(t){return new e(t)};return e}();return new d}(typeof r!=="undefined"?r:self);t["default"]=i;e.exports=t["default"]},function(e,t){"use strict";t.__esModule=true;var n=function(e){"use strict";var r=r||e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.OIndexedDB||e.msIndexedDB;if(!r){return}var t="local-forage-detect-blob-support";var n;var o;function i(r,t){r=r||[];t=t||{};try{return new Blob(r,t)}catch(a){if(a.name!=="TypeError"){throw a}var n=e.BlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder||e.WebKitBlobBuilder;var o=new n;for(var i=0;i<r.length;i+=1){o.append(r[i])}return o.getBlob(t.type)}}function a(e){var r=e.length;var t=new ArrayBuffer(r);var n=new Uint8Array(t);for(var o=0;o<r;o++){n[o]=e.charCodeAt(o)}return t}function s(e){return new Promise(function(r,t){var n=new XMLHttpRequest;n.open("GET",e);n.withCredentials=true;n.responseType="arraybuffer";n.onreadystatechange=function(){if(n.readyState!==4){return}if(n.status===200){return r({response:n.response,type:n.getResponseHeader("Content-Type")})}t({status:n.status,response:n.response})};n.send()})}function u(e){return new Promise(function(r,n){var o=i([""],{type:"image/png"});var a=e.transaction([t],"readwrite");a.objectStore(t).put(o,"key");a.oncomplete=function(){var o=e.transaction([t],"readwrite");var i=o.objectStore(t).get("key");i.onerror=n;i.onsuccess=function(e){var t=e.target.result;var n=URL.createObjectURL(t);s(n).then(function(e){r(!!(e&&e.type==="image/png"))},function(){r(false)}).then(function(){URL.revokeObjectURL(n)})}};a.onerror=a.onabort=n})["catch"](function(){return false})}function f(e){if(typeof n==="boolean"){return Promise.resolve(n)}return u(e).then(function(e){n=e;return n})}function c(e){return new Promise(function(r,t){var n=new FileReader;n.onerror=t;n.onloadend=function(t){var n=btoa(t.target.result||"");r({__local_forage_encoded_blob:true,data:n,type:e.type})};n.readAsBinaryString(e)})}function l(e){var r=a(atob(e.data));return i([r],{type:e.type})}function v(e){return e&&e.__local_forage_encoded_blob}function d(e){var r=this;var t=r._initReady().then(function(){var e=o[r._dbInfo.name];if(e&&e.dbReady){return e.dbReady}});t.then(e,e);return t}function h(e){var r=o[e.name];var t={};t.promise=new Promise(function(e){t.resolve=e});r.deferredOperations.push(t);if(!r.dbReady){r.dbReady=t.promise}else{r.dbReady=r.dbReady.then(function(){return t.promise})}}function p(e){var r=o[e.name];var t=r.deferredOperations.pop();if(t){t.resolve()}}function y(e){var r=this;var t={db:null};if(e){for(var n in e){t[n]=e[n]}}if(!o){o={}}var i=o[t.name];if(!i){i={forages:[],db:null,dbReady:null,deferredOperations:[]};o[t.name]=i}i.forages.push(r);if(!r._initReady){r._initReady=r.ready;r.ready=d}var a=[];function s(){return Promise.resolve()}for(var u=0;u<i.forages.length;u++){var f=i.forages[u];if(f!==r){a.push(f._initReady()["catch"](s))}}var c=i.forages.slice(0);return Promise.all(a).then(function(){t.db=i.db;return m(t)}).then(function(e){t.db=e;if(w(t,r._defaultConfig.version)){return b(t)}return e}).then(function(e){t.db=i.db=e;r._dbInfo=t;for(var n=0;n<c.length;n++){var o=c[n];if(o!==r){o._dbInfo.db=t.db;o._dbInfo.version=t.version}}})}function m(e){return g(e,false)}function b(e){return g(e,true)}function g(n,o){return new Promise(function(i,a){if(n.db){if(o){h(n);n.db.close()}else{return i(n.db)}}var s=[n.name];if(o){s.push(n.version)}var u=r.open.apply(r,s);if(o){u.onupgradeneeded=function(r){var o=u.result;try{o.createObjectStore(n.storeName);if(r.oldVersion<=1){o.createObjectStore(t)}}catch(t){if(t.name==="ConstraintError"){e.console.warn('The database "'+n.name+'"'+" has been upgraded from version "+r.oldVersion+" to version "+r.newVersion+', but the storage "'+n.storeName+'" already exists.')}else{throw t}}}}u.onerror=function(){a(u.error)};u.onsuccess=function(){i(u.result);p(n)}})}function w(r,t){if(!r.db){return true}var n=!r.db.objectStoreNames.contains(r.storeName);var o=r.version<r.db.version;var i=r.version>r.db.version;if(o){if(r.version!==t){e.console.warn('The database "'+r.name+'"'+" can't be downgraded from version "+r.db.version+" to version "+r.version+".")}r.version=r.db.version}if(i||n){if(n){var a=r.db.version+1;if(a>r.version){r.version=a}}return true}return false}function _(r,t){var n=this;if(typeof r!=="string"){e.console.warn(r+" used as a key, but it is not a string.");r=String(r)}var o=new Promise(function(e,t){n.ready().then(function(){var o=n._dbInfo;var i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName);var a=i.get(r);a.onsuccess=function(){var r=a.result;if(r===undefined){r=null}if(v(r)){r=l(r)}e(r)};a.onerror=function(){t(a.error)}})["catch"](t)});j(o,t);return o}function S(e,r){var t=this;var n=new Promise(function(r,n){t.ready().then(function(){var o=t._dbInfo;var i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName);var a=i.openCursor();var s=1;a.onsuccess=function(){var t=a.result;if(t){var n=t.value;if(v(n)){n=l(n)}var o=e(n,t.key,s++);if(o!==void 0){r(o)}else{t["continue"]()}}else{r()}};a.onerror=function(){n(a.error)}})["catch"](n)});j(n,r);return n}function E(r,t,n){var o=this;if(typeof r!=="string"){e.console.warn(r+" used as a key, but it is not a string.");r=String(r)}var i=new Promise(function(e,n){var i;o.ready().then(function(){i=o._dbInfo;if(t instanceof Blob){return f(i.db).then(function(e){if(e){return t}return c(t)})}return t}).then(function(t){var o=i.db.transaction(i.storeName,"readwrite");var a=o.objectStore(i.storeName);if(t===null){t=undefined}o.oncomplete=function(){if(t===undefined){t=null}e(t)};o.onabort=o.onerror=function(){var e=s.error?s.error:s.transaction.error;n(e)};var s=a.put(t,r)})["catch"](n)});j(i,n);return i}function I(r,t){var n=this;if(typeof r!=="string"){e.console.warn(r+" used as a key, but it is not a string.");r=String(r)}var o=new Promise(function(e,t){n.ready().then(function(){var o=n._dbInfo;var i=o.db.transaction(o.storeName,"readwrite");var a=i.objectStore(o.storeName);var s=a["delete"](r);i.oncomplete=function(){e()};i.onerror=function(){t(s.error)};i.onabort=function(){var e=s.error?s.error:s.transaction.error;t(e)}})["catch"](t)});j(o,t);return o}function A(e){var r=this;var t=new Promise(function(e,t){r.ready().then(function(){var n=r._dbInfo;var o=n.db.transaction(n.storeName,"readwrite");var i=o.objectStore(n.storeName);var a=i.clear();o.oncomplete=function(){e()};o.onabort=o.onerror=function(){var e=a.error?a.error:a.transaction.error;t(e)}})["catch"](t)});j(t,e);return t}function x(e){var r=this;var t=new Promise(function(e,t){r.ready().then(function(){var n=r._dbInfo;var o=n.db.transaction(n.storeName,"readonly").objectStore(n.storeName);var i=o.count();i.onsuccess=function(){e(i.result)};i.onerror=function(){t(i.error)}})["catch"](t)});j(t,e);return t}function P(e,r){var t=this;var n=new Promise(function(r,n){if(e<0){r(null);return}t.ready().then(function(){var o=t._dbInfo;var i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName);var a=false;var s=i.openCursor();s.onsuccess=function(){var t=s.result;if(!t){r(null);return}if(e===0){r(t.key)}else{if(!a){a=true;t.advance(e)}else{r(t.key)}}};s.onerror=function(){n(s.error)}})["catch"](n)});j(n,r);return n}function k(e){var r=this;var t=new Promise(function(e,t){r.ready().then(function(){var n=r._dbInfo;var o=n.db.transaction(n.storeName,"readonly").objectStore(n.storeName);var i=o.openCursor();var a=[];i.onsuccess=function(){var r=i.result;if(!r){e(a);return}a.push(r.key);r["continue"]()};i.onerror=function(){t(i.error)}})["catch"](t)});j(t,e);return t}function j(e,r){if(r){e.then(function(e){r(null,e)},function(e){r(e)})}}var C={_driver:"asyncStorage",_initStorage:y,iterate:S,getItem:_,setItem:E,removeItem:I,clear:A,length:x,key:P,keys:k};return C}(typeof r!=="undefined"?r:self);t["default"]=n;e.exports=t["default"]},function(e,t,n){"use strict";t.__esModule=true;var o=function(e){"use strict";var r=null;try{if(!e.localStorage||!("setItem"in e.localStorage)){return}r=e.localStorage}catch(e){return}function t(e){var r=this;var t={};if(e){for(var o in e){t[o]=e[o]}}t.keyPrefix=t.name+"/";if(t.storeName!==r._defaultConfig.storeName){t.keyPrefix+=t.storeName+"/"}r._dbInfo=t;return new Promise(function(e,r){e(n(3))}).then(function(e){t.serializer=e;return Promise.resolve()})}function o(e){var t=this;var n=t.ready().then(function(){var e=t._dbInfo.keyPrefix;for(var n=r.length-1;n>=0;n--){var o=r.key(n);if(o.indexOf(e)===0){r.removeItem(o)}}});v(n,e);return n}function i(t,n){var o=this;if(typeof t!=="string"){e.console.warn(t+" used as a key, but it is not a string.");t=String(t)}var i=o.ready().then(function(){var e=o._dbInfo;var n=r.getItem(e.keyPrefix+t);if(n){n=e.serializer.deserialize(n)}return n});v(i,n);return i}function a(e,t){var n=this;var o=n.ready().then(function(){var t=n._dbInfo;var o=t.keyPrefix;var i=o.length;var a=r.length;var s=1;for(var u=0;u<a;u++){var f=r.key(u);if(f.indexOf(o)!==0){continue}var c=r.getItem(f);if(c){c=t.serializer.deserialize(c)}c=e(c,f.substring(i),s++);if(c!==void 0){return c}}});v(o,t);return o}function s(e,t){var n=this;var o=n.ready().then(function(){var t=n._dbInfo;var o;try{o=r.key(e)}catch(e){o=null}if(o){o=o.substring(t.keyPrefix.length)}return o});v(o,t);return o}function u(e){var t=this;var n=t.ready().then(function(){var e=t._dbInfo;var n=r.length;var o=[];for(var i=0;i<n;i++){if(r.key(i).indexOf(e.keyPrefix)===0){o.push(r.key(i).substring(e.keyPrefix.length))}}return o});v(n,e);return n}function f(e){var r=this;var t=r.keys().then(function(e){return e.length});v(t,e);return t}function c(t,n){var o=this;if(typeof t!=="string"){e.console.warn(t+" used as a key, but it is not a string.");t=String(t)}var i=o.ready().then(function(){var e=o._dbInfo;r.removeItem(e.keyPrefix+t)});v(i,n);return i}function l(t,n,o){var i=this;if(typeof t!=="string"){e.console.warn(t+" used as a key, but it is not a string.");t=String(t)}var a=i.ready().then(function(){if(n===undefined){n=null}var e=n;return new Promise(function(o,a){var s=i._dbInfo;s.serializer.serialize(n,function(n,i){if(i){a(i)}else{try{r.setItem(s.keyPrefix+t,n);o(e)}catch(e){if(e.name==="QuotaExceededError"||e.name==="NS_ERROR_DOM_QUOTA_REACHED"){a(e)}a(e)}}})})});v(a,o);return a}function v(e,r){if(r){e.then(function(e){r(null,e)},function(e){r(e)})}}var d={_driver:"localStorageWrapper",_initStorage:t,iterate:a,getItem:i,setItem:l,removeItem:c,clear:o,length:f,key:s,keys:u};return d}(typeof r!=="undefined"?r:self);t["default"]=o;e.exports=t["default"]},function(e,t){"use strict";t.__esModule=true;var n=function(e){"use strict";var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var t="~~local_forage_type~";var n=/^~~local_forage_type~([^~]+)~/;var o="__lfsc__:";var i=o.length;var a="arbf";var s="blob";var u="si08";var f="ui08";var c="uic8";var l="si16";var v="si32";var d="ur16";var h="ui32";var p="fl32";var y="fl64";var m=i+a.length;function b(r,t){r=r||[];t=t||{};try{return new Blob(r,t)}catch(a){if(a.name!=="TypeError"){throw a}var n=e.BlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder||e.WebKitBlobBuilder;var o=new n;for(var i=0;i<r.length;i+=1){o.append(r[i])}return o.getBlob(t.type)}}function g(e,r){var n="";if(e){n=e.toString()}if(e&&(e.toString()==="[object ArrayBuffer]"||e.buffer&&e.buffer.toString()==="[object ArrayBuffer]")){var i;var m=o;if(e instanceof ArrayBuffer){i=e;m+=a}else{i=e.buffer;if(n==="[object Int8Array]"){m+=u}else if(n==="[object Uint8Array]"){m+=f}else if(n==="[object Uint8ClampedArray]"){m+=c}else if(n==="[object Int16Array]"){m+=l}else if(n==="[object Uint16Array]"){m+=d}else if(n==="[object Int32Array]"){m+=v}else if(n==="[object Uint32Array]"){m+=h}else if(n==="[object Float32Array]"){m+=p}else if(n==="[object Float64Array]"){m+=y}else{r(new Error("Failed to get type for BinaryArray"))}}r(m+S(i))}else if(n==="[object Blob]"){var b=new FileReader;b.onload=function(){var n=t+e.type+"~"+S(this.result);r(o+s+n)};b.readAsArrayBuffer(e)}else{try{r(JSON.stringify(e))}catch(t){console.error("Couldn't convert value into a JSON string: ",e);r(null,t)}}}function w(e){if(e.substring(0,i)!==o){return JSON.parse(e)}var r=e.substring(m);var t=e.substring(i,m);var g;if(t===s&&n.test(r)){var w=r.match(n);g=w[1];r=r.substring(w[0].length)}var S=_(r);switch(t){case a:return S;case s:return b([S],{type:g});case u:return new Int8Array(S);case f:return new Uint8Array(S);case c:return new Uint8ClampedArray(S);case l:return new Int16Array(S);case d:return new Uint16Array(S);case v:return new Int32Array(S);case h:return new Uint32Array(S);case p:return new Float32Array(S);case y:return new Float64Array(S);default:throw new Error("Unkown type: "+t)}}function _(e){var t=e.length*.75;var n=e.length;var o;var i=0;var a,s,u,f;if(e[e.length-1]==="="){t--;if(e[e.length-2]==="="){t--}}var c=new ArrayBuffer(t);var l=new Uint8Array(c);for(o=0;o<n;o+=4){a=r.indexOf(e[o]);s=r.indexOf(e[o+1]);u=r.indexOf(e[o+2]);f=r.indexOf(e[o+3]);l[i++]=a<<2|s>>4;l[i++]=(s&15)<<4|u>>2;l[i++]=(u&3)<<6|f&63}return c}function S(e){var t=new Uint8Array(e);var n="";var o;for(o=0;o<t.length;o+=3){n+=r[t[o]>>2];n+=r[(t[o]&3)<<4|t[o+1]>>4];n+=r[(t[o+1]&15)<<2|t[o+2]>>6];n+=r[t[o+2]&63]}if(t.length%3===2){n=n.substring(0,n.length-1)+"="}else if(t.length%3===1){n=n.substring(0,n.length-2)+"=="}return n}var E={serialize:g,deserialize:w,stringToBuffer:_,bufferToString:S};return E}(typeof r!=="undefined"?r:self);t["default"]=n;e.exports=t["default"]},function(e,t,n){"use strict";t.__esModule=true;var o=function(e){"use strict";var r=e.openDatabase;if(!r){return}function t(e){var t=this;var o={db:null};if(e){for(var i in e){o[i]=typeof e[i]!=="string"?e[i].toString():e[i]}}var a=new Promise(function(e,n){try{o.db=r(o.name,String(o.version),o.description,o.size)}catch(e){return n(e)}o.db.transaction(function(r){r.executeSql("CREATE TABLE IF NOT EXISTS "+o.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){t._dbInfo=o;e()},function(e,r){n(r)})})});return new Promise(function(e,r){e(n(3))}).then(function(e){o.serializer=e;return a})}function o(r,t){var n=this;if(typeof r!=="string"){e.console.warn(r+" used as a key, but it is not a string.");r=String(r)}var o=new Promise(function(e,t){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[r],function(r,t){var n=t.rows.length?t.rows.item(0).value:null;if(n){n=o.serializer.deserialize(n)}e(n)},function(e,r){t(r)})})})["catch"](t)});v(o,t);return o}function i(e,r){var t=this;var n=new Promise(function(r,n){t.ready().then(function(){var o=t._dbInfo;o.db.transaction(function(t){t.executeSql("SELECT * FROM "+o.storeName,[],function(t,n){var i=n.rows;var a=i.length;for(var s=0;s<a;s++){var u=i.item(s);var f=u.value;if(f){f=o.serializer.deserialize(f)}f=e(f,u.key,s+1);if(f!==void 0){r(f);return}}r()},function(e,r){n(r)})})})["catch"](n)});v(n,r);return n}function a(r,t,n){var o=this;if(typeof r!=="string"){e.console.warn(r+" used as a key, but it is not a string.");r=String(r)}var i=new Promise(function(e,n){o.ready().then(function(){if(t===undefined){t=null}var i=t;var a=o._dbInfo;a.serializer.serialize(t,function(t,o){if(o){n(o)}else{a.db.transaction(function(o){o.executeSql("INSERT OR REPLACE INTO "+a.storeName+" (key, value) VALUES (?, ?)",[r,t],function(){e(i)},function(e,r){n(r)})},function(e){if(e.code===e.QUOTA_ERR){n(e)}})}})})["catch"](n)});v(i,n);return i}function s(r,t){var n=this;if(typeof r!=="string"){e.console.warn(r+" used as a key, but it is not a string.");r=String(r)}var o=new Promise(function(e,t){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("DELETE FROM "+o.storeName+" WHERE key = ?",[r],function(){e()},function(e,r){t(r)})})})["catch"](t)});v(o,t);return o}function u(e){var r=this;var t=new Promise(function(e,t){r.ready().then(function(){var n=r._dbInfo;n.db.transaction(function(r){r.executeSql("DELETE FROM "+n.storeName,[],function(){e()},function(e,r){t(r)})})})["catch"](t)});v(t,e);return t}function f(e){var r=this;var t=new Promise(function(e,t){r.ready().then(function(){var n=r._dbInfo;n.db.transaction(function(r){r.executeSql("SELECT COUNT(key) as c FROM "+n.storeName,[],function(r,t){var n=t.rows.item(0).c;e(n)},function(e,r){t(r)})})})["catch"](t)});v(t,e);return t}function c(e,r){var t=this;var n=new Promise(function(r,n){t.ready().then(function(){var o=t._dbInfo;o.db.transaction(function(t){t.executeSql("SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,t){var n=t.rows.length?t.rows.item(0).key:null;r(n)},function(e,r){n(r)})})})["catch"](n)});v(n,r);return n}function l(e){var r=this;var t=new Promise(function(e,t){r.ready().then(function(){var n=r._dbInfo;n.db.transaction(function(r){r.executeSql("SELECT key FROM "+n.storeName,[],function(r,t){var n=[];for(var o=0;o<t.rows.length;o++){n.push(t.rows.item(o).key)}e(n)},function(e,r){t(r)})})})["catch"](t)});v(t,e);return t}function v(e,r){if(r){e.then(function(e){r(null,e)},function(e){r(e)})}}var d={_driver:"webSQLStorage",_initStorage:t,iterate:i,getItem:o,setItem:a,removeItem:s,clear:u,length:f,key:c,keys:l};return d}(typeof r!=="undefined"?r:self);t["default"]=o;e.exports=t["default"]}])})});var a=n(function(e){function r(e){var r,t,n="";if(e.length%2!==0){e+=" "}for(r=0,t=e.length;r<t;r+=2){n+=String.fromCharCode(e.charCodeAt(r)*256+e.charCodeAt(r+1))}return n}function t(e){var r,t,n,o,i,a,s,u,f,c,l,v,d,h,p,y,m;var b=String.fromCharCode;var g="";var w=e.length>>4<<4;for(r=0;r<w;r++){t=e.charCodeAt(r);n=e.charCodeAt(++r);o=e.charCodeAt(++r);i=e.charCodeAt(++r);a=e.charCodeAt(++r);s=e.charCodeAt(++r);u=e.charCodeAt(++r);f=e.charCodeAt(++r);c=e.charCodeAt(++r);l=e.charCodeAt(++r);v=e.charCodeAt(++r);d=e.charCodeAt(++r);h=e.charCodeAt(++r);p=e.charCodeAt(++r);y=e.charCodeAt(++r);m=e.charCodeAt(++r);g+=b(t>>8,t&255,n>>8,n&255,o>>8,o&255,i>>8,i&255,a>>8,a&255,s>>8,s&255,u>>8,u&255,f>>8,f&255,c>>8,c&255,l>>8,l&255,v>>8,v&255,d>>8,d&255,h>>8,h&255,p>>8,p&255,y>>8,y&255,m>>8,m&255)}for(w=e.length;r<w;r++){t=e.charCodeAt(r);g+=b(t>>8)+b(t&255)}return g}e.exports={compress:r,decompress:t}});var s=new Headers({"Content-Type":"application/json",Accept:"application/json"});var u=new Map;var f=new Map;var c=new Map;c.set("lady_ada_king","Lady_Ada_King (The Developer)");u.upToDate=false;f.upToDate=false;function l(e){if(!e.ok){return e.json().then(function(e){if(r&&r.location&&e.error==="No username param"){document.body.classList.remove("user-logged-in");throw false}else{throw Error(e.error)}},function(e){console.error(e);throw Error(e.message)})}else{return e}}function v(){var e=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];var t=e.start;var n=e.amount;var i=e.cache;var a=e.sent;var v=a?u:f;return fetch("/api/get"+(a?"-sent":"")+"-messages?start="+(t||0)+"&amount="+(n||10)+(i?"&sw-cache":""),{method:"POST",credentials:"same-origin",headers:s}).then(l).then(function(e){return e.json()}).then(function(e){v.upToDate=false;e.forEach(function(e){e.sent=!!a;if(v.has(e.messageId)){v.upToDate=true}c.set(e.from.toLowerCase(),e.from);c.set(e.to.toLowerCase(),e.to);v.set(e.messageId,e)});if(r&&r.$&&r.$("#emoji__recipient")){r.$("#emoji__recipient").fire("correrspondentsUpdated")}return e.filter(function(e){return(typeof e==="undefined"?"undefined":o.typeof(e))==="object"})})}importScripts("/sw-toolbox.js");importScripts("https://twemoji.maxcdn.com/2/twemoji.min.js");toolbox.router.default=toolbox.fastest;toolbox.router.any("/api/*",function(e){if(new URL(e.url).search.split("&").indexOf("sw-cache")!==-1){return toolbox.fastest(e)}else{return toolbox.networkOnly(e)}});toolbox.router.any("/auth/*",toolbox.networkOnly);toolbox.router.any(/\/(index\.html)?$/i,toolbox.networkFirst);function d(e){var r={title:"Something Has Happened",message:"Here's something you might want to check out.",icon:"launcher-icon-4x.png"};if(e.data){r=Promise.resolve(e.data.json())}else{r=v({amount:1}).then(function(e){return e[0]}).then(function(e){if(e.type==="message"){var r=void 0;try{r=twemoji.parse(e.message[0]).match(/http[^"]+\.png/);r=r[0]}catch(e){}return{title:e.from+" says: "+e.message.join(""),icon:r||"launcher-icon-4x.png"}}else if(e.type==="photo"){var t="https://81.ada.is/images/get-image?postid="+e.messageId;var n=e.from+" sent a photo";return{title:n,icon:t}}})}var t=clients.matchAll({type:"window"}).then(function(e){e.forEach(function(e){e.navigate("/#refresh")})});return Promise.all([r,t]).then(function(){
return r})}self.addEventListener("notificationclick",function(e){e.notification.close();e.waitUntil(clients.matchAll({type:"window"}).then(function(e){for(var r=0;r<e.length;r++){var t=e[r];if("focus"in t){return t.focus()}}if(clients.openWindow)return clients.openWindow("/")}))});self.addEventListener("push",function(e){if(!(self.Notification&&self.Notification.permission==="granted")){return}if(!("showNotification"in ServiceWorkerRegistration.prototype)){console.warn("Notifications aren't supported.");return}var r=d(e).then(function(e){return self.registration.showNotification(e.title,e)});e.waitUntil(r)})})();
//# sourceMappingURL=sw.min.js.map